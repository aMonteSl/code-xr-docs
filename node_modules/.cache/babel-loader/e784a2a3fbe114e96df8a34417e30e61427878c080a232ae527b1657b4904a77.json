{"ast":null,"code":"const EXTENSION_ID = 'aMonteSl.code-xr';\nasync function obtenerVersionYMetricasCodeXR() {\n  var _data$results$, _versionObj$version, _ref, _statsObj$installCoun, _statsObj$averageRati, _statsObj$ratingCount, _statsObj$downloads;\n  const url = 'https://marketplace.visualstudio.com/_apis/public/gallery/extensionquery?api-version=3.0-preview.1';\n  const body = {\n    filters: [{\n      criteria: [{\n        filterType: 7,\n        value: EXTENSION_ID // \"aMonteSl.code-xr\"\n      }],\n      pageNumber: 1,\n      pageSize: 1\n    }],\n    // 0x100 (IncludeStatistics) + 0x1 (IncludeVersions) + 0x200 (IncludeLatestVersionOnly) = 769\n    flags: 769\n  };\n  console.log('üîç Body de la petici√≥n:', JSON.stringify(body, null, 2));\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Accept': 'application/json;api-version=3.0-preview.1'\n    },\n    body: JSON.stringify(body)\n  });\n  if (!response.ok) {\n    throw new Error(`Error al consultar API: ${response.status} ${response.statusText}`);\n  }\n  const data = await response.json();\n  const ext = (_data$results$ = data.results[0]) === null || _data$results$ === void 0 ? void 0 : _data$results$.extensions[0];\n  if (!ext) {\n    throw new Error('La extensi√≥n Code-XR no fue encontrada en el Marketplace.');\n  }\n\n  // ‚Äî‚Äî 1. Versiones ‚Äî‚Äî  \n  // Con IncludeVersions + IncludeLatestVersionOnly, ext.versions ‚âÉ [ { ‚Ä¶datos de la √∫ltima versi√≥n‚Ä¶ } ]\n  const versionObj = Array.isArray(ext.versions) && ext.versions[0];\n  const versionActual = (_versionObj$version = versionObj === null || versionObj === void 0 ? void 0 : versionObj.version) !== null && _versionObj$version !== void 0 ? _versionObj$version : 'Desconocida';\n  console.log('üè∑Ô∏è Versi√≥n obtenida:', versionActual);\n\n  // ‚Äî‚Äî 2. Estad√≠sticas ‚Äî‚Äî  \n  const statsObj = {};\n  for (const s of ext.statistics || []) {\n    statsObj[s.statisticName] = s.value;\n  }\n  const totalInstalaciones = (_ref = (_statsObj$installCoun = statsObj.installCount) !== null && _statsObj$installCoun !== void 0 ? _statsObj$installCoun : statsObj.install) !== null && _ref !== void 0 ? _ref : 0;\n  const promedioRating = (_statsObj$averageRati = statsObj.averageRating) !== null && _statsObj$averageRati !== void 0 ? _statsObj$averageRati : 0;\n  const totalValoraciones = (_statsObj$ratingCount = statsObj.ratingCount) !== null && _statsObj$ratingCount !== void 0 ? _statsObj$ratingCount : 0;\n  const totalDescargas = (_statsObj$downloads = statsObj.downloads) !== null && _statsObj$downloads !== void 0 ? _statsObj$downloads : 0;\n  return {\n    version: versionActual,\n    totalInstalaciones,\n    promedioRating,\n    totalValoraciones,\n    totalDescargas\n  };\n}\n\n// Ejecuci√≥n de ejemplo\n(async () => {\n  try {\n    const info = await obtenerVersionYMetricasCodeXR();\n    console.log('Code-XR ‚Üí versi√≥n y m√©tricas:', info);\n    // Por ejemplo:\n    // {\n    //   version: '1.2.0',\n    //   totalInstalaciones: 38,\n    //   promedioRating: 5.0,\n    //   totalValoraciones: 1,\n    //   totalDescargas: 38\n    // }\n  } catch (err) {\n    console.error(err);\n  }\n})();","map":{"version":3,"names":["EXTENSION_ID","obtenerVersionYMetricasCodeXR","_data$results$","_versionObj$version","_ref","_statsObj$installCoun","_statsObj$averageRati","_statsObj$ratingCount","_statsObj$downloads","url","body","filters","criteria","filterType","value","pageNumber","pageSize","flags","console","log","JSON","stringify","response","fetch","method","headers","ok","Error","status","statusText","data","json","ext","results","extensions","versionObj","Array","isArray","versions","versionActual","version","statsObj","s","statistics","statisticName","totalInstalaciones","installCount","install","promedioRating","averageRating","totalValoraciones","ratingCount","totalDescargas","downloads","info","err","error"],"sources":["/home/adrian/web_code_xr/src/utils/marketplaceAPI.js"],"sourcesContent":["const EXTENSION_ID = 'aMonteSl.code-xr';\n\nasync function obtenerVersionYMetricasCodeXR() {\n  const url = 'https://marketplace.visualstudio.com/_apis/public/gallery/extensionquery?api-version=3.0-preview.1';\n\n  const body = {\n    filters: [\n      {\n        criteria: [\n          {\n            filterType: 7,\n            value: EXTENSION_ID  // \"aMonteSl.code-xr\"\n          }\n        ],\n        pageNumber: 1,\n        pageSize: 1\n      }\n    ],\n    // 0x100 (IncludeStatistics) + 0x1 (IncludeVersions) + 0x200 (IncludeLatestVersionOnly) = 769\n    flags: 769 \n  };\n\n  console.log('üîç Body de la petici√≥n:', JSON.stringify(body, null, 2));\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Accept': 'application/json;api-version=3.0-preview.1'\n    },\n    body: JSON.stringify(body)\n  });\n\n  if (!response.ok) {\n    throw new Error(`Error al consultar API: ${response.status} ${response.statusText}`);\n  }\n\n  const data = await response.json();\n  const ext = data.results[0]?.extensions[0];\n  if (!ext) {\n    throw new Error('La extensi√≥n Code-XR no fue encontrada en el Marketplace.');\n  }\n\n  // ‚Äî‚Äî 1. Versiones ‚Äî‚Äî  \n  // Con IncludeVersions + IncludeLatestVersionOnly, ext.versions ‚âÉ [ { ‚Ä¶datos de la √∫ltima versi√≥n‚Ä¶ } ]\n  const versionObj = Array.isArray(ext.versions) && ext.versions[0];\n  const versionActual = versionObj?.version ?? 'Desconocida';\n  console.log('üè∑Ô∏è Versi√≥n obtenida:', versionActual);\n\n  // ‚Äî‚Äî 2. Estad√≠sticas ‚Äî‚Äî  \n  const statsObj = {};\n  for (const s of ext.statistics || []) {\n    statsObj[s.statisticName] = s.value;\n  }\n  const totalInstalaciones = statsObj.installCount ?? statsObj.install ?? 0;\n  const promedioRating       = statsObj.averageRating         ?? 0;\n  const totalValoraciones    = statsObj.ratingCount           ?? 0;\n  const totalDescargas       = statsObj.downloads             ?? 0;\n\n  return {\n    version: versionActual,\n    totalInstalaciones,\n    promedioRating,\n    totalValoraciones,\n    totalDescargas\n  };\n}\n\n// Ejecuci√≥n de ejemplo\n(async () => {\n  try {\n    const info = await obtenerVersionYMetricasCodeXR();\n    console.log('Code-XR ‚Üí versi√≥n y m√©tricas:', info);\n    // Por ejemplo:\n    // {\n    //   version: '1.2.0',\n    //   totalInstalaciones: 38,\n    //   promedioRating: 5.0,\n    //   totalValoraciones: 1,\n    //   totalDescargas: 38\n    // }\n  } catch (err) {\n    console.error(err);\n  }\n})();\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}